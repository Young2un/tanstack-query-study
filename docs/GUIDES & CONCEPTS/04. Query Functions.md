# **Query Functions**

`queryFn`ì€ ì¿¼ë¦¬ì—ì„œ ë°ì´í„°ë¥¼ ì‹¤ì œë¡œ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜

â†’ ë°˜ë“œì‹œ **Promiseë¥¼ ë°˜í™˜**í•´ì•¼ í•¨

â†’ ì„±ê³µ ì‹œ `resolve`, ì‹¤íŒ¨ ì‹œ `throw` ë˜ëŠ” `Promise.reject()` í•´ì•¼ í•¨

â†’ `fetch` ì‚¬ìš© ì‹œì—ëŠ” HTTP ìƒíƒœë¥¼ í™•ì¸í•´ì„œ ì§ì ‘ throw í•´ì•¼ í•¨ (`res.ok` ì²´í¬í•´ì„œ ì—ëŸ¬ ì²˜ë¦¬)

```tsx
queryFn: async () => {
  const res = await fetch("/todos/1");
  if (!res.ok) throw new Error("ì‘ë‹µ ì—ëŸ¬");
  return res.json();
};
```

â†’ `queryFn` ì²« ë²ˆì§¸ ì¸ìë¡œ `queryKey` ë°›ì•„ì˜¬ ìˆ˜ ìˆìŒ

`queryFn`ì˜ ì¸ìëŠ” `QueryFunctionContext` ê°ì²´ë¡œ, ì—¬ê¸°ì— `queryKey`ê°€ í¬í•¨ë˜ì–´ ìˆìŒ

â‡’ **ì¿¼ë¦¬ í‚¤ì—ì„œ ë³€ìˆ˜ ì¶”ì¶œí•´ì„œ ì¿¼ë¦¬ í•¨ìˆ˜ë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥** ğŸ’¬Â ë„ˆë¬´ ì•¼ë¬´ì§.. ì´ë ‡ê²Œ ì“°ê³  ì‹¶ë‹¤

```tsx
useQuery({
  queryKey: ["todos", { status, page }],
  queryFn: fetchTodos,
});

function fetchTodos({ queryKey }) {
  const [_key, { status, page }] = queryKey;
  return fetchTodosFromServer(status, page);
}
```

â†’ `QueryFunctionContext` ê°ì²´ ì •ë¦¬

| ì†ì„±       | ì„¤ëª…                                              |
| ---------- | ------------------------------------------------- |
| `queryKey` | ì¿¼ë¦¬ ì‹ë³„ í‚¤ (ë°°ì—´)                               |
| `client`   | í˜„ì¬ QueryClient ì¸ìŠ¤í„´ìŠ¤                         |
| `signal`   | `AbortSignal` â€“ ì¿¼ë¦¬ ì·¨ì†Œìš©                       |
| `meta`     | ì¶”ê°€ ë©”íƒ€ ì •ë³´ (ì„ íƒ) ë¡œê·¸ê°™ì€ê±° ì°ì–´ë³¼ ë•Œ ì¢‹ì„ë“¯ |

\*\*\*\*ğŸ’¬Â ì¼ë‹¨ì€ ìˆë‹¤ëŠ”ê²ƒë§Œ ì•Œì•„ë‘ê³  ì¨ë´ì•¼ ì•Œë“¯

- ì¶”ê°€ì ìœ¼ë¡œ `useInfiniteQuery` (ë¬´í•œìŠ¤í¬ë¡¤ í• ë•Œ ë“±)ëŠ” `InfiniteQueryContext` ë°›ìŒ

| ì†ì„±                                    | ì„¤ëª…                                                          |
| --------------------------------------- | ------------------------------------------------------------- |
| `pageParam`                             | í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸/ë°ì´í„°                                       |
| `direction` (ì§€ê¸ˆì€ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ âŒ!!) | ë°©í–¥ (ì•/ë’¤ í˜ì´ì§€) â†’ ì§ì ‘ ì“°ì§€ ë§ê³  `pageParam`ì— í¬í•¨ì‹œí‚¤ì |

`pageParam`ë§Œ ì•Œë©´ ë˜ëŠ”ë°

ì´ ê°’ì€ ì–´ë””ì„œ ì˜¤ëƒë©´ `useInfiniteQuery`ì˜ `getNextPageParam`, `getPreviousPageParam` ë¦¬í„´ê°’ì´ ìë™ìœ¼ë¡œ ë‹¤ìŒ `queryFn` ì‹¤í–‰ ì‹œ `pageParam`ìœ¼ë¡œ ë“¤ì–´ê°
